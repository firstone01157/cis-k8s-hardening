{
    "excluded_rules": {
        "1.1.12": "RISK_ACCEPTED",
        "1.2.15": "IGNORED",
        "2.7": "RISK_ACCEPTED"
    },
    "skip_rules": [],
    "custom_parameters": {
        "kube_config": "/etc/kubernetes/admin.conf"
    },
    "health_check": {
        "check_services": [ "kubelet", "containerd", "etcd" ],
        "check_ports": [ 6443, 10250 ],
        "api_health_url": "https://localhost:6443/healthz"
    },
    "logging": {
        "enabled": true,
        "log_dir": "logs"
    },
    "remediation_config": {
        "global": {
            "backup_enabled": true,
            "backup_dir": "/var/backups/cis-remediation",
            "dry_run": false,
            "wait_for_api": true,
            "api_check_interval": 5,
            "api_max_retries": 60
        },
        "checks": {
            "3.2.1": {
                "enabled": true,
                "skip": false,
                "audit_policy_path": "/etc/kubernetes/audit-policy.yaml",
                "audit_log_path": "/var/log/k8s-audit.log",
                "audit_log_maxage": "30",
                "audit_log_maxbackup": "10",
                "audit_log_maxsize": "100",
                "audit_level": "Metadata",
                "log_sensitive_resources": true,
                "sensitive_resources": [ "secrets", "configmaps", "pods/exec", "pods/attach" ]
            },
            "3.2.2": {
                "enabled": true,
                "skip": false,
                "audit_policy_path": "/etc/kubernetes/audit-policy.yaml",
                "audit_log_path": "/var/log/kubernetes/audit/audit.log",
                "audit_log_maxage": 30,
                "audit_log_maxbackup": 10,
                "audit_log_maxsize": 100,
                "audit_level": "Metadata",
                "description": "Ensure that the audit policy covers key security concerns (Master Node)"
            },
            "5.2.1": {
                "enabled": true,
                "skip": false,
                "safe_mode_namespace": "default",
                "secure_namespace": "secure-zone",
                "mode": "warn-audit",
                "description": "Pod Security Standards - default namespace (Safe Mode)",
                "namespaces": {
                    "default": {
                        "warn": "restricted",
                        "audit": "restricted",
                        "enforce": "disabled"
                    }
                }
            },
            "5.3.2": {
                "enabled": true,
                "skip": false,
                "policy_type": "allow-all",
                "description": "Ensure that all Namespaces have Network Policies defined (Allow-All Mode for Safety)"
            },
            "5.6.1": {
                "enabled": true,
                "skip": false,
                "admin_namespace": "secure-zone",
                "create_secure_zone": true,
                "secure_zone_config": {
                    "name": "secure-zone",
                    "enforce": "restricted"
                }
            },
            "1.3.1": {
                "enabled": false,
                "skip": false,
                "threshold": 12500,
                "config_file": "/etc/kubernetes/manifests/kube-controller-manager.yaml"
            },
            "2.1": {
                "enabled": false,
                "skip": false,
                "cert_file": "/etc/kubernetes/pki/etcd/server.crt",
                "key_file": "/etc/kubernetes/pki/etcd/server.key",
                "config_file": "/etc/kubernetes/manifests/etcd.yaml"
            },
            "4.1.9": {
                "enabled": true,
                "skip": false,
                "description": "Ensure kubelet configuration files have file permissions set to 600 or more restrictive (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "file_mode": "600"
            },
            "4.2.1": {
                "enabled": true,
                "skip": false,
                "description": "Ensure anonymous-auth is set to false (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "anonymous_auth": false
            },
            "4.2.3": {
                "enabled": true,
                "skip": false,
                "description": "Ensure client CA file is set appropriately (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "client_ca_file": "/etc/kubernetes/pki/ca.crt"
            },
            "4.2.4": {
                "enabled": true,
                "skip": false,
                "description": "Ensure read-only port is set to 0 (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "read_only_port": 0
            },
            "4.2.5": {
                "enabled": true,
                "skip": false,
                "description": "Ensure streaming connection idle timeout is set appropriately (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "streaming_timeout": "4h0m0s"
            },
            "4.2.6": {
                "enabled": true,
                "skip": false,
                "description": "Ensure make-iptables-util-chains argument is set to true (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "make_iptables_util_chains": true
            },
            "4.2.10": {
                "enabled": true,
                "skip": false,
                "description": "Ensure kubelet certificate rotation is enabled (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "rotate_certificates": true
            },
            "4.2.11": {
                "enabled": true,
                "skip": false,
                "description": "Ensure kubelet server certificate rotation is enabled (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "rotate_server_certificates": true
            },
            "4.2.12": {
                "enabled": true,
                "skip": false,
                "description": "Ensure kubelet TLS cipher suites are configured correctly (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "tls_cipher_suites": [
                    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305",
                    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
                    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305",
                    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384"
                ]
            },
            "4.2.13": {
                "enabled": true,
                "skip": false,
                "description": "Ensure pod PIDs limit is set appropriately (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "pod_pids_limit": -1
            },
            "4.2.14": {
                "enabled": true,
                "skip": false,
                "description": "Ensure seccomp default is set appropriately (Worker Node)",
                "config_file": "/var/lib/kubelet/config.yaml",
                "seccomp_default": true
            },
            "1.2.14": {
                "enabled": true,
                "skip": false,
                "description": "Ensure that the admission control plugin NodeRestriction is set (Master Node)",
                "config_file": "/etc/kubernetes/manifests/kube-apiserver.yaml",
                "admission_plugin": "NodeRestriction"
            },
            "5.2.7": {
                "enabled": true,
                "skip": false,
                "description": "Minimize the admission of root containers (Master Node)"
            },
            "5.2.9": {
                "enabled": true,
                "skip": false,
                "description": "Minimize the admission of containers with added capabilities (Master Node)"
            }
        },
        "environment_overrides": {
            "PSS_MODE": "warn-audit",
            "AUDIT_LEVEL": "Metadata",
            "ENFORCE_MODE": "disabled",
            "DRY_RUN": "false"
        }
    }
}