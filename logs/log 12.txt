dos2unix: converting file ./kube-bench/helper_scripts/check_files_owner_in_dir.sh to Unix format...
dos2unix: converting file ./master_remediate_only.sh to Unix format...
dos2unix: Failed to open temporary output file: Permission denied
dos2unix: problems converting file ./remediation_artifacts/5.1.1_fix.sh
master@terramaster:~/CIS_Kubernetes_Benchmark_V1.12.0$ sudo python3 cis_k8s_unified.py -vv
[!] Config not found. Using defaults.

======================================================================
  CIS Kubernetes Benchmark - Unified Interactive Runner
  ตัวรันเครื่องมือตรวจสอบ CIS Kubernetes แบบรวมและโต้ตอบ
  Version: 1.0 (Optimized)
  Date: 2025-11-28 03:51:03
======================================================================

[*] Checking Cluster Health...
[DEBUG] Using Kubeconfig: /etc/kubernetes/admin.conf
    -> CRITICAL (Nodes Unreachable)

======================================================================
SELECT MODE
======================================================================

  1) Audit only (non-destructive)
  2) Remediation only (DESTRUCTIVE)
  3) Both (Audit then Remediation)
  4) Health Check
  5) Help
  0) Exit

Choose [0-5]: 1

AUDIT CONFIGURATION

  Kubernetes Role:
    1) Master only
    2) Worker only
    3) Both

  Select role [3]: 1

  CIS Level:
    1) Level 1
    2) Level 2
    3) All

  Select level [3]: 1

[*] Starting Audit Scan...

======================================================================
[PASS] 1.1.12 - Ensure that the etcd data directory ownership is set to etcd:etcd (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.12...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /var/lib/etcd is root:root
stat: cannot statx '"/var/lib/etcd"': No such file or directory


======================================================================
[PASS] 1.1.15 - Ensure that the scheduler.conf file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.15...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/scheduler.conf are 600
stat: cannot statx '"/etc/kubernetes/scheduler.conf"': No such file or directory


======================================================================
[PASS] 1.1.13 - Ensure that the default administrative credential file permissions are set to 600 (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.13...
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/admin.conf are 600
 - Check Passed: Permissions on /etc/kubernetes/super-admin.conf are 600
stat: cannot statx '"/etc/kubernetes/admin.conf"': No such file or directory
stat: cannot statx '"/etc/kubernetes/super-admin.conf"': No such file or directory


======================================================================
[PASS] 1.1.16 - Ensure that the scheduler.conf file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.16...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/scheduler.conf is root:root
stat: cannot statx '"/etc/kubernetes/scheduler.conf"': No such file or directory


======================================================================
[PASS] 1.1.19 - Ensure that the Kubernetes PKI directory and file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.19...
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All files and directories in /etc/kubernetes/pki are owned by root:root


======================================================================
[PASS] 1.1.11 - Ensure that the etcd data directory permissions are set to 700 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.11...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /var/lib/etcd are 700
stat: cannot statx '"/var/lib/etcd"': No such file or directory


======================================================================
[PASS] 1.1.18 - Ensure that the controller-manager.conf file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.18...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/controller-manager.conf is root:root
stat: cannot statx '"/etc/kubernetes/controller-manager.conf"': No such file or directory


======================================================================
[PASS] 1.1.10 - Ensure that the Container Network Interface file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.10...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/cni/net.d/10-flannel.conflist is root:root
stat: cannot statx '"/etc/cni/net.d/10-flannel.conflist"': No such file or directory


======================================================================
[PASS] 1.1.14 - Ensure that the default administrative credential file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.14...
[CMD] Executing: l_owner=
[INFO] Check Passed
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/admin.conf is root:root
 - Check Passed: Ownership on /etc/kubernetes/super-admin.conf is root:root
stat: cannot statx '"/etc/kubernetes/admin.conf"': No such file or directory
stat: cannot statx '"/etc/kubernetes/super-admin.conf"': No such file or directory


======================================================================
[PASS] 1.1.1 - Ensure that the API server pod specification file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.1...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/manifests/kube-apiserver.yaml are 600
stat: cannot statx '"/etc/kubernetes/manifests/kube-apiserver.yaml"': No such file or directory


======================================================================
[PASS] 1.1.17 - Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.17...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/controller-manager.conf are 600
stat: cannot statx '"/etc/kubernetes/controller-manager.conf"': No such file or directory


======================================================================
[PASS] 1.1.2 - Ensure that the API server pod specification file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.2...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/manifests/kube-apiserver.yaml is root:root
stat: cannot statx '"/etc/kubernetes/manifests/kube-apiserver.yaml"': No such file or directory


======================================================================
[PASS] 1.1.4 - Ensure that the controller manager pod specification file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.4...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/manifests/kube-controller-manager.yaml is root:root
stat: cannot statx '"/etc/kubernetes/manifests/kube-controller-manager.yaml"': No such file or directory


======================================================================
[PASS] 1.1.3 - Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.3...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/manifests/kube-controller-manager.yaml are 600
stat: cannot statx '"/etc/kubernetes/manifests/kube-controller-manager.yaml"': No such file or directory


======================================================================
[PASS] 1.1.6 - Ensure that the scheduler pod specification file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.6...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/manifests/kube-scheduler.yaml is root:root
stat: cannot statx '"/etc/kubernetes/manifests/kube-scheduler.yaml"': No such file or directory


======================================================================
[PASS] 1.1.5 - Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.5...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/manifests/kube-scheduler.yaml are 600
stat: cannot statx '"/etc/kubernetes/manifests/kube-scheduler.yaml"': No such file or directory


======================================================================
[PASS] 1.1.7 - Ensure that the etcd pod specification file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.7...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/manifests/etcd.yaml are 600
stat: cannot statx '"/etc/kubernetes/manifests/etcd.yaml"': No such file or directory


======================================================================
[PASS] 1.1.8 - Ensure that the etcd pod specification file ownership is set to root:root (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.8...
[CMD] Executing: l_owner=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Ownership on /etc/kubernetes/manifests/etcd.yaml is root:root
stat: cannot statx '"/etc/kubernetes/manifests/etcd.yaml"': No such file or directory


======================================================================
[PASS] 1.1.9 - Ensure that the Container Network Interface file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.9...
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/cni/net.d/10-flannel.conflist are 600
stat: cannot statx '"/etc/cni/net.d/10-flannel.conflist"': No such file or directory


======================================================================
[PASS] 1.2.10 - Ensure that the admission control plugin AlwaysAdmit is not set (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.10...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E "\s--enable-admission-plugins(=|\s|$)" | grep -q "AlwaysAdmit"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: AlwaysAdmit is not enabled


======================================================================
[FAIL] 1.2.15 - Ensure that the --profiling argument is set to false (Automated)
======================================================================
  Reason: Check Failed: --profiling is not set to false in process or manifest
  Fix:    Run remediation script: 1.2.15_remediate.sh

  [Output]
[INFO] Starting check for 1.2.15...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--profiling=false(\s|$)"; then
[CMD] Executing: grep for profiling in /etc/kubernetes/manifests/kube-apiserver.yaml
[INFO] Check Failed
[FAIL_REASON] Check Failed: --profiling is not set to false in process or manifest
[FIX_HINT] Run remediation script: 1.2.15_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --profiling is not set to false in process or manifest


======================================================================
[FAIL] 1.2.16 - Ensure that the --audit-log-path argument is set (Automated)
======================================================================
  Reason: Check Failed: --audit-log-path is not set
  Fix:    Run remediation script: 1.2.16_remediate.sh

  [Output]
[INFO] Starting check for 1.2.16...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--audit-log-path(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --audit-log-path is not set
[FIX_HINT] Run remediation script: 1.2.16_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --audit-log-path is not set


======================================================================
[MANUAL] 1.2.11 - Ensure that the admission control plugin AlwaysPullImages is set (Manual)
======================================================================
  Reason: Check Failed: AlwaysPullImages is NOT enabled

  [Output]
[INFO] Starting check for 1.2.11...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E "\s--enable-admission-plugins=.*(,|\s)AlwaysPullImages(,|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: AlwaysPullImages is NOT enabled
[FIX_HINT] Run remediation script: 1.2.11_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: AlwaysPullImages is NOT enabled


======================================================================
[FAIL] 1.2.17 - Ensure that the --audit-log-maxage argument is set to 30 or as appropriate (Automated)
======================================================================
  Reason: Check Failed: --audit-log-maxage is not set
  Fix:    Run remediation script: 1.2.17_remediate.sh

  [Output]
[INFO] Starting check for 1.2.17...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--audit-log-maxage(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --audit-log-maxage is not set
[FIX_HINT] Run remediation script: 1.2.17_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --audit-log-maxage is not set


======================================================================
[FAIL] 1.2.18 - Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated)
======================================================================
  Reason: Check Failed: --audit-log-maxbackup is not set
  Fix:    Run remediation script: 1.2.18_remediate.sh

  [Output]
[INFO] Starting check for 1.2.18...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--audit-log-maxbackup(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --audit-log-maxbackup is not set
[FIX_HINT] Run remediation script: 1.2.18_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --audit-log-maxbackup is not set


======================================================================
[FAIL] 1.2.19 - Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated)
======================================================================
  Reason: Check Failed: --audit-log-maxsize is not set
  Fix:    Run remediation script: 1.2.19_remediate.sh

  [Output]
[INFO] Starting check for 1.2.19...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--audit-log-maxsize(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --audit-log-maxsize is not set
[FIX_HINT] Run remediation script: 1.2.19_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --audit-log-maxsize is not set


======================================================================
[MANUAL] 1.2.1 - Ensure that the --anonymous-auth argument is set to false (Manual)
======================================================================
  Reason: Check Failed: --anonymous-auth is NOT set to false

  [Output]
[INFO] Starting check for 1.2.1...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--anonymous-auth=false(\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --anonymous-auth is NOT set to false
[FIX_HINT] Run remediation script: 1.2.1_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --anonymous-auth is NOT set to false


======================================================================
[PASS] 1.2.22 - Ensure that the --service-account-key-file argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.22...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--service-account-key-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --service-account-key-file is set in manifest


======================================================================
[PASS] 1.2.20 - Ensure that the --request-timeout argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.20...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--request-timeout(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --request-timeout is set in manifest


======================================================================
[PASS] 1.2.21 - Ensure that the --service-account-lookup argument is set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.21...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -q -- "--service-account-lookup=false"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --service-account-lookup is not set to false


======================================================================
[PASS] 1.1.20 - Ensure that the Kubernetes PKI certificate file permissions are set to 644 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.20...
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver-kubelet-client.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/peer.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/server.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/ca.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/healthcheck-client.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/front-proxy-ca.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/front-proxy-client.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver-etcd-client.crt are 644
 - Check Passed: Permissions on /etc/kubernetes/pki/ca.crt are 644
stat: cannot statx '"/etc/kubernetes/pki/apiserver-kubelet-client.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/peer.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/server.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/ca.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/healthcheck-client.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/apiserver.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/front-proxy-ca.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/front-proxy-client.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/apiserver-etcd-client.crt"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/ca.crt"': No such file or directory


======================================================================
[PASS] 1.1.21 - Ensure that the Kubernetes PKI key file permissions are set to 600 (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.1.21...
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed
[CMD] Executing: l_mode=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: Permissions on /etc/kubernetes/pki/front-proxy-client.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/peer.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/server.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/ca.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/etcd/healthcheck-client.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/sa.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/ca.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver-etcd-client.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/apiserver-kubelet-client.key are 600
 - Check Passed: Permissions on /etc/kubernetes/pki/front-proxy-ca.key are 600
stat: cannot statx '"/etc/kubernetes/pki/front-proxy-client.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/apiserver.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/peer.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/server.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/ca.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/etcd/healthcheck-client.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/sa.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/ca.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/apiserver-etcd-client.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/apiserver-kubelet-client.key"': No such file or directory
stat: cannot statx '"/etc/kubernetes/pki/front-proxy-ca.key"': No such file or directory


======================================================================
[PASS] 1.2.23 - Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.23...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--etcd-certfile(=|\s|$)" && \
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --etcd-certfile and --etcd-keyfile are set in manifest


======================================================================
[PASS] 1.2.25 - Ensure that the --client-ca-file argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.25...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--client-ca-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --client-ca-file is set in manifest


======================================================================
[PASS] 1.2.24 - Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.24...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--tls-cert-file(=|\s|$)" && \
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --tls-cert-file and --tls-private-key-file are set in manifest


======================================================================
[PASS] 1.2.2 - Ensure that the --token-auth-file parameter is not set (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.2...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--token-auth-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --token-auth-file is not set


======================================================================
[MANUAL] 1.2.28 - Ensure that encryption providers are appropriately configured (Manual)
======================================================================
  Reason: Check Failed: --encryption-provider-config is not set

  [Output]
[INFO] Starting check for 1.2.28...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--encryption-provider-config(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --encryption-provider-config is not set
[FIX_HINT] Run remediation script: 1.2.28_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --encryption-provider-config is not set


======================================================================
[MANUAL] 1.2.27 - Ensure that the --encryption-provider-config argument is set as appropriate (Manual)
======================================================================
  Reason: Check Failed: --encryption-provider-config argument is not set

  [Output]
[INFO] Starting check for 1.2.27...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--encryption-provider-config(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --encryption-provider-config argument is not set
[FIX_HINT] Run remediation script: 1.2.27_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --encryption-provider-config argument is not set


======================================================================
[PASS] 1.2.26 - Ensure that the --etcd-cafile argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.26...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--etcd-cafile(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --etcd-cafile is set in manifest


======================================================================
[FAIL] 1.2.29 - Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Automated)
======================================================================
  Reason: Check Failed: --tls-cipher-suites is not set
  Fix:    Run remediation script: 1.2.29_remediate.sh

  [Output]
[INFO] Starting check for 1.2.29...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--tls-cipher-suites(=|\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --tls-cipher-suites is not set
[FIX_HINT] Run remediation script: 1.2.29_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --tls-cipher-suites is not set


======================================================================
[FAIL] 1.2.30 - Ensure that the --service-account-extend-token-expiration parameter is set to false (Automated)
======================================================================
  Reason: Check Failed: --service-account-extend-token-expiration is not set to false
  Fix:    Run remediation script: 1.2.30_remediate.sh

  [Output]
[INFO] Starting check for 1.2.30...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--service-account-extend-token-expiration=false(\s|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --service-account-extend-token-expiration is not set to false
[FIX_HINT] Run remediation script: 1.2.30_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --service-account-extend-token-expiration is not set to false


======================================================================
[MANUAL] 1.2.3 - Ensure that the DenyServiceExternalIPs is set (Manual)
======================================================================
  Reason: Check Failed: DenyServiceExternalIPs is NOT enabled

  [Output]
[INFO] Starting check for 1.2.3...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E "\s--enable-admission-plugins(=|\s|$)" | grep -q "DenyServiceExternalIPs"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: DenyServiceExternalIPs is NOT enabled
[FIX_HINT] Run remediation script: 1.2.3_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: DenyServiceExternalIPs is NOT enabled


======================================================================
[FAIL] 1.2.7 - Ensure that the --authorization-mode argument includes Node (Automated)
======================================================================
  Reason: Check Failed: --authorization-mode does NOT include Node
  Fix:    Run remediation script: 1.2.7_remediate.sh

  [Output]
[INFO] Starting check for 1.2.7...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -- "--authorization-mode=.*(,|$)Node(,|$)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --authorization-mode does NOT include Node
[FIX_HINT] Run remediation script: 1.2.7_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --authorization-mode does NOT include Node


======================================================================
[FAIL] 1.2.8 - Ensure that the --authorization-mode argument includes RBAC (Automated)
======================================================================
  Reason: Check Failed: --authorization-mode does NOT include RBAC
  Fix:    Run remediation script: 1.2.8_remediate.sh

  [Output]
[INFO] Starting check for 1.2.8...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E "\s--authorization-mode(=|\s|$)" | grep -q "RBAC"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --authorization-mode does NOT include RBAC
[FIX_HINT] Run remediation script: 1.2.8_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --authorization-mode does NOT include RBAC


======================================================================
[PASS] 1.3.3 - Ensure that the --use-service-account-credentials argument is set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.3.3...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--use-service-account-credentials=true(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --use-service-account-credentials is set to true


======================================================================
[PASS] 1.3.2 - Ensure that the --profiling argument is set to false (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.3.2...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--profiling=false(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --profiling is set to false


======================================================================
[MANUAL] 1.3.1 - Ensure that the --terminated-pod-gc-threshold argument is set as appropriate (Manual)
======================================================================

  [Output]
[INFO] Starting check for 1.3.1...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--terminated-pod-gc-threshold(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --terminated-pod-gc-threshold is set


======================================================================
[PASS] 1.2.4 - Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.4...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--kubelet-client-certificate(=|\s|$)" && \
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --kubelet-client-certificate and --kubelet-client-key are set in manifest


======================================================================
[PASS] 1.2.6 - Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.6...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -- "--authorization-mode=.*AlwaysAllow"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --authorization-mode does not contain AlwaysAllow


======================================================================
[MANUAL] 1.2.9 - Ensure that the admission control plugin EventRateLimit is set (Manual)
======================================================================
  Reason: Check Failed: EventRateLimit is NOT enabled

  [Output]
[INFO] Starting check for 1.2.9...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E "\s--enable-admission-plugins(=|\s|$)" | grep -q "EventRateLimit"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: EventRateLimit is NOT enabled
[FIX_HINT] Run remediation script: 1.2.9_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: EventRateLimit is NOT enabled


======================================================================
[PASS] 1.2.5 - Ensure that the --kubelet-certificate-authority argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.2.5...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -E -q "\s--kubelet-certificate-authority(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --kubelet-certificate-authority is set in manifest


======================================================================
[PASS] 1.3.4 - Ensure that the --service-account-private-key-file argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.3.4...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--service-account-private-key-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --service-account-private-key-file is set


======================================================================
[FAIL] 1.3.6 - Ensure that the RotateKubeletServerCertificate argument is set to true (Automated)
======================================================================
  Reason: Check Failed: RotateKubeletServerCertificate is not set to true
  Fix:    Run remediation script: 1.3.6_remediate.sh

  [Output]
[INFO] Starting check for 1.3.6...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "(^|\s|,)RotateKubeletServerCertificate=true($|\s|,)"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: RotateKubeletServerCertificate is not set to true
[FIX_HINT] Run remediation script: 1.3.6_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: RotateKubeletServerCertificate is not set to true


======================================================================
[PASS] 1.3.7 - Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.3.7...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--bind-address=127.0.0.1(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --bind-address is set to 127.0.0.1


======================================================================
[PASS] 1.3.5 - Ensure that the --root-ca-file argument is set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.3.5...
[CMD] Executing: if ps -ef | grep kube-controller-manager | grep -v grep | grep -E -q "\s--root-ca-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --root-ca-file is set


======================================================================
[PASS] 2.5 - Ensure that the --peer-client-cert-auth argument is set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.5...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--peer-client-cert-auth=true(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --peer-client-cert-auth is set to true


======================================================================
[PASS] 2.2 - Ensure that the --client-cert-auth argument is set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.2...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--client-cert-auth=true(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --client-cert-auth is set to true


======================================================================
[PASS] 2.6 - Ensure that the --peer-auto-tls argument is not set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.6...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--peer-auto-tls=true(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --peer-auto-tls is not set to true


======================================================================
[PASS] 1.4.1 - Ensure that the --profiling argument is set to false (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.4.1...
[CMD] Executing: if ps -ef | grep kube-scheduler | grep -v grep | grep -E -q "\s--profiling=false(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --profiling is set to false


======================================================================
[PASS] 1.4.2 - Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
======================================================================

  [Output]
[INFO] Starting check for 1.4.2...
[CMD] Executing: if ps -ef | grep kube-scheduler | grep -v grep | grep -E -q "\s--bind-address=127.0.0.1(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --bind-address is set to 127.0.0.1


======================================================================
[PASS] 2.3 - Ensure that the --auto-tls argument is not set to true (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.3...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--auto-tls=true(\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --auto-tls is not set to true


======================================================================
[PASS] 2.1 - Ensure that the --cert-file and --key-file arguments are set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.1...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--cert-file(=|\s|$)" && \
[CMD] Executing: ps -ef | grep etcd | grep -v grep | grep -E -q "\s--key-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --cert-file and --key-file are set


======================================================================
[PASS] 2.4 - Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate (Automated)
======================================================================

  [Output]
[INFO] Starting check for 2.4...
[CMD] Executing: if ps -ef | grep etcd | grep -v grep | grep -E -q "\s--peer-cert-file(=|\s|$)" && \
[CMD] Executing: ps -ef | grep etcd | grep -v grep | grep -E -q "\s--peer-key-file(=|\s|$)"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --peer-cert-file and --peer-key-file are set


======================================================================
[PASS] 4.1.1 - Ensure that the kubelet service file permissions are set to 600 or more restrictive (Automated)
======================================================================

  [Output]
[INFO] Starting check for 4.1.1...
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: /etc/systemd/system/kubelet.service.d/10-kubeadm.conf not found (Audit not applicable or file missing)


======================================================================
[MANUAL] 3.1.1 - Client certificate authentication should not be used for users (Manual)
======================================================================

  [Output]
[INFO] Starting check for 3.1.1...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -q -- "--client-ca-file"; then
[INFO] Check Passed


======================================================================
[MANUAL] 3.2.1 - Ensure that a minimal audit policy is created (Manual)
======================================================================
  Reason: Check Failed: --audit-policy-file is not set

  [Output]
[INFO] Starting check for 3.2.1...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -q -- "--audit-policy-file"; then
[INFO] Check Failed
[FAIL_REASON] Check Failed: --audit-policy-file is not set
[FIX_HINT] Run remediation script: 3.2.1_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: --audit-policy-file is not set


======================================================================
[MANUAL] 3.1.2 - Service account token authentication should not be used for users (Manual)
======================================================================

  [Output]
[INFO] Starting check for 3.1.2...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -q -- "--service-account-lookup=true"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Manual Check: --service-account-lookup is NOT set to true.


======================================================================
[MANUAL] 3.1.3 - Bootstrap token authentication should not be used for users (Manual)
======================================================================

  [Output]
[INFO] Starting check for 3.1.3...
[CMD] Executing: if ps -ef | grep kube-apiserver | grep -v grep | grep -q -- "--enable-bootstrap-token-auth=true"; then
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: --enable-bootstrap-token-auth is not set to true


======================================================================
[MANUAL] 5.1.10 - Minimize access to the proxy sub-resource of nodes (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.10...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for nodes/proxy access
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with nodes/proxy access


======================================================================
[MANUAL] 5.1.13 - Minimize access to the service account token creation (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.13...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for serviceaccount token creation
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with serviceaccount token creation access


======================================================================
[MANUAL] 5.1.12 - Minimize access to webhook configuration objects (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.12...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for webhook configuration access
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with webhook config access


======================================================================
[MANUAL] 5.1.11 - Minimize access to the approval sub-resource of certificatesigningrequests objects (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.11...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for CSR approval
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with CSR approval access


======================================================================
[MANUAL] 5.1.6 - Ensure that Service Account Tokens are only mounted where necessary (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.6...
[CMD] Executing: kubectl get pods -A -o json | jq filter for automountServiceAccountToken
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All pods have automountServiceAccountToken explicitly disabled


======================================================================
[FAIL] 5.1.1 - Ensure that the cluster-admin role is only used where required
======================================================================
  Reason: Check Error: Unable to connect to Kubernetes cluster
  Fix:    Check kubeconfig and cluster connectivity.

  [Output]
[INFO] Starting check for 5.1.1...
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: if ! kubectl cluster-info &>/dev/null; then
[INFO] Check Failed
[FAIL_REASON] Check Error: Unable to connect to Kubernetes cluster
[FIX_HINT] Check kubeconfig and cluster connectivity.

- Audit Result:
  [-] ERROR
 - Check Error: Unable to connect to Kubernetes cluster


======================================================================
[MANUAL] 5.1.5 - Ensure that default service accounts are not actively used. (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.5...
[CMD] Executing: # Verify kubectl is available
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: kubectl get pods --all-namespaces -o json | jq filter for default service accounts
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No pods actively using default service account (excluding kube-system)


======================================================================
[MANUAL] 5.1.4 - Minimize access to create pods (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.4...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for pod create/update permissions
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with overly broad pods creation access


======================================================================
[MANUAL] 5.1.8 - Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.8...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for bind/impersonate/escalate verbs
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with bind/impersonate/escalate permissions


======================================================================
[MANUAL] 5.1.7 - Avoid use of system:masters group (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.7...
[CMD] Executing: kubectl get clusterrolebindings -o json | jq filter for system:masters group
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No ClusterRoleBindings using system:masters group


======================================================================
[MANUAL] 5.1.9 - Minimize access to create persistent volumes (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.9...
[CMD] Executing: kubectl get roles,clusterroles -A -o json | jq filter for persistentvolume create
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No Roles/ClusterRoles with persistentvolumes creation access


======================================================================
[MANUAL] 5.1.2 - Minimize access to secrets (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.1.2...
[CMD] Executing: # Verify kubectl is available
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: kubectl get clusterroles -o json | jq filter for secrets access
[CMD] Executing: kubectl get roles -A -o json | jq filter for secrets access
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: No non-system Roles/ClusterRoles with overly broad secrets access


======================================================================
[PASS] 5.2.12 - Minimize the admission of containers which use HostPorts
======================================================================

  [Output]
[INFO] Starting check for 5.2.12...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.2 - Minimize the admission of privileged containers
======================================================================

  [Output]
[INFO] Starting check for 5.2.2...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.11 - Minimize the admission of HostPath volumes
======================================================================

  [Output]
[INFO] Starting check for 5.2.11...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.10 - Minimize the admission of Windows HostProcess Containers
======================================================================

  [Output]
[INFO] Starting check for 5.2.10...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.1 - Ensure that the cluster has at least one active policy control mechanism in place
======================================================================

  [Output]
[INFO] Starting check for 5.2.1...
[CMD] Executing: # Verify kubectl is available
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name | test(\"^(kube-system|kube-public)$\") | not) | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.4 - Minimize the admission of containers wishing to share the host IPC namespace
======================================================================

  [Output]
[INFO] Starting check for 5.2.4...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.3 - Minimize the admission of containers wishing to share the host process ID namespace
======================================================================

  [Output]
[INFO] Starting check for 5.2.3...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[MANUAL] 5.3.1 - Ensure that the CNI in use supports Network Policies (Manual)
======================================================================

  [Output]
[INFO] Starting check for 5.3.1...
[CMD] Executing: # Verify kubectl is available
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: kubectl get ns -o json | jq filter for non-system namespaces
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have at least one NetworkPolicy


======================================================================
[PASS] 5.2.6 - Minimize the admission of containers with allowPrivilegeEscalation
======================================================================

  [Output]
[INFO] Starting check for 5.2.6...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.2.8 - Minimize the admission of containers with the NET_RAW capability
======================================================================

  [Output]
[INFO] Starting check for 5.2.8...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[PASS] 5.3.2 - Ensure that all Namespaces have Network Policies defined
======================================================================

  [Output]
[INFO] Starting check for 5.3.2...
[CMD] Executing: if ! command -v kubectl &> /dev/null; then
[CMD] Executing: namespaces=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have at least one NetworkPolicy


======================================================================
[PASS] 5.2.5 - Minimize the admission of containers wishing to share the host network namespace
======================================================================

  [Output]
[INFO] Starting check for 5.2.5...
[CMD] Executing: missing_labels=
[INFO] Check Passed

- Audit Result:
  [+] PASS
 - Check Passed: All non-system namespaces have 'pod-security.kubernetes.io/enforce' label
jq: error: syntax error, unexpected INVALID_CHARACTER (Unix shell quoting issues?) at <top-level>, line 1:
.items[] | select(.metadata.name != \"kube-system\" and .metadata.name != \"kube-public\") | select(.metadata.labels[\"pod-security.kubernetes.io/enforce\"] == null) | .metadata.name
jq: 1 compile error


======================================================================
[MANUAL] 5.6.1 - Create administrative boundaries between resources using namespaces (Manual)
======================================================================
  Reason: Only system namespaces exist. Create custom namespaces for workload isolation.

  [Output]
[INFO] Starting check for 5.6.1...
[CMD] Executing: kubectl get namespaces -o json | jq .items | length
[CMD] Executing: kubectl get namespaces -o json | jq filter for non-system namespaces count
[INFO] Check Failed
[FAIL_REASON] Check Failed: No custom administrative boundaries found
[FIX_HINT] Run remediation script: 5.6.1_remediate.sh
[INFO] Check Failed
[FAIL_REASON] Only system namespaces exist. Create custom namespaces for workload isolation.
[FIX_HINT] Run remediation script: 5.6.1_remediate.sh

- Audit Result:
  [-] FAIL
 - Reason(s) for audit failure:
 - Check Failed: No custom administrative boundaries found
 - Only system namespaces exist. Create custom namespaces for workload isolation.
/home/master/CIS_Kubernetes_Benchmark_V1.12.0/Level_1_Master_Node/5.6.1_audit.sh: line 19: [: : integer expression expected


[+] Audit Complete.

   [*] Reports saved to: /home/master/CIS_Kubernetes_Benchmark_V1.12.0/reports/2025-11-28/audit/run_20251128_035103

======================================================================
STATISTICS SUMMARY
======================================================================

  MASTER:
    Pass:    58
    Fail:    11
    Manual:  24
    Skipped: 0
    Total:   93
    Success: 62%

======================================================================

======================================================================
TREND ANALYSIS (Score Comparison)
======================================================================
  Current Score:   62.37%
  Previous Score:  55.91%
  Change:          📈 +6.46%
======================================================================

======================================================================
RESULTS MENU
======================================================================

  1) View summary
  2) View failed items
  3) View HTML report
  4) Return to main menu

Choose [1-4]:
